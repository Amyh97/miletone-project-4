# Testing

The first step that I took in testing my code was to use the W3C Validators for both [HTML](https://validator.w3.org/) and [CSS](https://jigsaw.w3.org/css-validator/), then validated my JavaScript with [JS Hint](https://jshint.com/) and used [PEP8](http://pep8online.com/) to validate my Python code. On a few occasions I found that a line of code was too long to pass the validation, but breaking the line to fit caused other errors, including not being able to find a template. Where this has occurred, I have added a code comment explaining that the error could not be rectified without causing other issues. I then went on to check the console for any errors while interacting with my site and checked the Python terminal for any error codes caused by these interactions. 

Once I was sure the code was valid and correct, I moved on to testing it from a user perspective. The first thing I checked was that the external link in the footer opened a new tab, so that the user did not lose the original site. I then moved onto testing the basics, like checking the nav bar links went to the correct location and the correct menu options were displayed depending on if there was a user logged in and if that user was a super user. Having checked these basics I turned to my user stories to ensure that the site meets the set requirements. To do this I took the steps necessary to achieve what the user wanted and took steps to see what would happen if I were not able to achieve the goal. 

| Story number | Steps taken                                                                                                                                                | Outcome                                                                                                                                                                                                                                    |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1            | 1) navigate to the products page, either browse, filter or search products using options at the top of the page.                                           | Taking these steps allowed me to full fill this user story as I was able to browse products and services available.                                                                                                                          |
|              | 2) Navigate to the services page to see services available.                                                                                                 | Having taken these steps I was not able to find what I wanted, however there was an option to contact the photographer directly.                                                                                                           |
| 2            | 1) navigate to the contact page via the need something else link on the home page,                                                                        | By following these steps, I was able to send an email to the photographer and saw a message pop up on the screen alerting me to the fact the email has been sent.                                                                          |
|              | 2) Fill out a form with my details in                                                                                                                      | While filling out the form I missed a field/ did not enter an email and I was not able to submit the form but was alerted to which field(s) were causing the errors.                                                                      |
| 3            | 1) I added some items to my cart and navigated to the basket page                                                                                          | I was able to see exactly what was in my basket and I was happy with it, so I was able to proceed.                                                                                                                                         |
|              |                                                                                                                                                            | I was not happy with the items in my basket, but I was able to remove items from the basket and update the quantities.                                                                                                                     |
| 4            | 1) navigate to the register page from the header of the website                                                                                            | I was able to successfully fill out the form in the register page and was sent an email asking me to confirm my email address.                                                                                                              |
|              | 2) fill in details to create and account and verify with email                                                                                             | I took these steps but was unable to create an account based on the form data, however the errors were highlighted, including not entering a name, and errors with passwords being too common, too short or too like their username.  |
| 5            | 1) log in (if not already)                                                                                                                                 | From this page I was able to see my past orders and click on them to see the full breakdown.                                                                                                                                              |
|              | 2) navigate to the profiles page                                                                                                                           | I was not able to see the order status as this is a future feature of the store as it will help customers know where the order is.                                                                                                       |
| 6            | 1) navigate to the profiles page, edit the form and update                                                                                                 | I was able to take either of these steps and was able to update my info, and I could see a success message to confirm this                                                                                                                 |
|              | OR 2) change the details while checking out and select save info to update data.                                                                           | I was able to get to an update form, however I was unable to update as there was an error in the data, however I received prompts as to where the errors were                                                                                |
| 7            | 1) when logged in as a super user, navigate to manage content, select if it is a product or service being added and submit the form                         | When taking these steps, I received a success message when I added a product. In addition, I got an info message telling me I was editing an item, and a success message when it had been done.                                              |
|              | 2) navigate to the product detail/ service detail to access a form to update the product.                                                                  | I was unable to carry out these tasks, however, prompts on the screen pointed out the errors, so they could be removed for submission.                                                                                                      |
| 8            | 1) navigate to an order page and see what is in process and update status.                                                                               | I was not able to achieve this goal as it is covered in the future features left to implement, however there is no link to this page as to avoid a 404 error.                                                                             |
|              |                                                                                                                                                            |                                                                                                                                                                                                                                            |
| 9            | As a user I navigated to the contact photographer form and filled it out as referenced in user story 2.                                                    | I was able to take these steps and were able to send an email address.                                                                                                                                                                     |
|              | As the site owner I could see the email come into the Gmail account (as this is also the address used to send emails, therefore keeps the email consistent | While trying this in the development environment I was able to print the email to the console, this allowed me to check that it was capturing the users email, subject and message correctly.                                              |

The next step I took in testing my website was to add, search for, update and delete test products and services to check that the functions worked properly. After this, I sent my site for peer review. During peer review some spelling errors were spotted on the site, but these changes needed to be made on the deployed site so that the corrections were on the correct database. In doing this I was able to test updating items, where I ran into a minor error. However, this did give me the opportunity to check that my custom error pages worked (rather than using the standard browser 404 error page), before correcting the original bag (typo in the redirect function)

I then used the developer tools in my browser to manipulate the website to render as if on different screen sizes. On the smaller screen sizes, I hid the logo element as the header was taking up much of the screen. In addition, I removed some margin around the card elements on mobile devises as to best utilise the space available. The most noticeable change here is the menu becomes a hamburger button on smaller view ports as not to take up the entire screen with the header. Although these changes were relatively minor, they had a massive impact on the user experience. When I sent my deployed site to friends and family for review, it was brought to my attention that I needed to add some margin bottom to the add to basket button on the services page as on of my users had a phone (iPhone 12) that did not match the ones used in the dev tools. 

Once I was happy with how the website worked and looked, I opened my website in Google Chrome and used [Lighthouse](https://developers.google.com/web/tools/lighthouse) to test performance, accessibility and best practice on my website. While accessibility always ranged between 91 and 100 (out of 100) and best practices were consistently at 93, the results on each page from the performance varied greatly. In order to see what I could do (if anything) to improve this I went further into the report to see why the results varied so greatly between 23 and 62 on most pages. When looking into the reasons for these scores I could see that it was partly due to all the third-party libraries being loaded in base.html. However, I decided not to change this in order to ensure that every file has access to the necessary libraries, rather than load them only in the files needed and risk missing a link. The pages that scored the lowest were ones that were affected by the issue with loading third party libraries, but also contained a lot of images. When building the site,  I was aware that the image files were large and would take a ling time to load. In order to try and overcome this I ran them all through [Tiny  PNG]( https://tinypng.com/) three times, with the file sizes decreasing each time. However, I decided not to compress the images further as the purpose of the website is to sell the images, therefore I wanted users to accurately see what they are buying. 

## Issues and Resolutions
-	Early on in development, on account sign up was getting an error saying the AUTH_PASSORD_VALIDATOR settings were improperly configured. To fix I had to ignore the pep8 compliance and have them as one long line each (these lines also have a comment in the code next to them).
-	When implementing the pricing of products, everything cost £1.20 as it was only taking the values of the first option. Had to initialize value then set it to selected option to work out prices. However, after feedback, this logic changed again, while the JavaScript referenced here is still used to show the user the price, the basket app pulls the data from the database as to avoid users changing the values in the dev tools and exploiting a weakness in the code. 
-	Product filtering not working. Fix – use print statements to see what if statements were being hit, first if request. GET, then if category search in request. GET. Then I needed to correct syntax to use square brackets to get the value of the category search from the URL. I was then able to print what category I was searching by but got nothing returned. I then decided to initialize the product variable as none at the top of the function (like you do for the search parameter). Then if there was the get in the request, I could set the product variable to only return the relevant images and if there was no get the product variable was set to all products.
-	Filter but more than 10 items so need pagination. Fix- change to 18 items per page as there is no category with more than that many items in it. I ran into issues with the URL, when you clicked onto the next page it re-ran the logic and looked at request. GET again, which had now lost the category search so gave page 2 of all products. I looked at changing “page = request.GET.get(‘page’,1)” to look at the products dataset rather than the request. However, QuerySet is not callable, and neither was putting it into a list, array or dictionary, so for now I have had to change the number of items per page, but in the future, this could be looked at, and allow users to select how many items per page. 
-	Issue - Code act differently on Heroku vs Gitpod. Fix – This issue required tutor support, but no one could work out why, so I rebuilt the basket item’s structure to make it neater and easier to understand. This new structure also meant that it could be reused when the services were added to the project (as variable names were chosen so they could apply to both products and services). 
-	Another issue I had on the deployed site but not the development one was the images in the basket were not showing up, both before and after re-structuring the basket. This was due to how I was splitting the key-value pairs to get the image location was being split at the “:” which also split the URL to AWS after https. To overcome this, I added “,1” to the split function to only split it at the first instance of the character so the URL stayed whole.

